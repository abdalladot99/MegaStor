@model DetailsProductViewModel
 
@{
    double avgRating = Model.product.AverageRating;
    int fullStars = (int)avgRating;
    bool halfStar = avgRating - fullStars >= 0.5;
    int emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
	var phoneSeller = Model.product.Vendor.PhoneNumber;  

}

<div class="section">
	<!-- container -->
	<div class="container">
		<!-- row -->
		<div class="row">
			<!-- Product main img -->
			<div class="col-md-5 col-md-push-2">
				<div id="product-main-img">
					<div class="product-preview">
						<img src="/img/@Model.product.ImageUrl" alt="">
					</div>
					@foreach (var i in Model.product.ProductImages)
					{
						<div class="product-preview">
							<img src="/img/@i.ImageURL" alt="">
						</div>

					}
 
				</div>
			</div>
			<!-- /Product main img -->
			<!-- Product thumb imgs -->
			<div class="col-md-2  col-md-pull-5">
				<div id="product-imgs">
					<div class="product-preview">
						<img src="~/img/@Model.product.ImageUrl" alt="">
					</div>

					@foreach (var i in Model.product.ProductImages)
					{
						<div class="product-preview">
							<img src="/img/@i.ImageURL" alt="">
						</div>

					}

				</div>
			</div>
			<!-- /Product thumb imgs -->
			<!-- Product details -->
			<div class="col-md-5">
				<div class="product-details">
					<h2 class="product-name">product name goes here</h2>
					<div>
						<div class="product-rating">

							@for (int i = 0; i < fullStars; i++)
							{
							    <!-- نجمة كاملة -->
							    <i class="fa fa-star"></i>
							}

							@if (halfStar)
							{
								 <!-- نص نجمة -->
								<i class="fa fa-star-half-o"></i>
							}

							@for (int i = 0; i < emptyStars; i++)
							{
								<!-- نجمة فاضية -->
			 					<i class="fa fa-star-o"></i>

							}
							<span> (@avgRating from 5)</span>
							 
						</div>
						<a class="review-link" href="#">@Model.product.Reviews.Count Review(s) | Add your review</a>
					</div>
					<div>
						@if (Model.product.DiscountPrice != Model.product.Price)
						{
							<h4 class="product-price">$@Model.product.DiscountPrice <del class="product-old-price">$@Model.product.Price</del></h4>
						}
						else
						{
							<h4 class="product-price">$@Model.product.Price <del class="product-old-price"></del></h4>
						}
						@if (Model.product.IsAvailable)
						{
							<span class="product-available">In Stock</span>
						}else
						{
							<span class="product-available">Currently Unavailable</span> 
						}
					</div>

 					 

					<div class="add-to-cart">
						 

 							<form asp-action="AddToCart" asp-controller="Cart" method="post" class="mt-3">

								<input type="hidden" name="id" value="@Model.product.Id" />

								<button type="submit" class="add-to-cart-btn"> <i class="fa fa-shopping-cart"></i> add to cart</button>


							</form>
 					</div>

					<ul class="product-btns">
						<li>
							<form asp-controller="Wishlists" asp-action="AddWishList" method="post" style="display:inline;">
								<input type="hidden" name="id" value="@Model.product.Id" /> 
								<button  type="submit" style="all: unset; cursor: pointer;">
								    <i class="fa fa-heart-o"></i>
							 		add to wishlist 
								</button>
							</form>
						</li>
						<li><a href="#"><i class="fa fa-exchange"></i> add to compare</a></li>
					</ul>
 
					<ul class="product-links">
						<li>Category:</li>
						<li><a asp-controller="SubCategory" asp-action="Details" asp-route-id="@Model.product.SubCategoryId">@Model.product.SubCategory.CategoryName</a></li>
					</ul>  
					<!-- Font Awesome -->
					<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

					<ul class="product-links">
						<li>
							<a href="https://wa.me/@phoneSeller?text=Hi, I'm interested in your product @Model.product.Name in Category @Model.product.Category.Name. It has a price of @Model.product.DiscountPrice"
							   target="_blank"
							   style="color: #25D366; font-weight: bold;">
								<i class="fab fa-whatsapp" style="margin-right: 5px;"></i> Contact Seller
							</a>
						</li>
					</ul>
  

				</div>
			</div>
			<!-- /Product details -->
			<!-- Product tab -->
			<div class="col-md-12">
				<div id="product-tab">
					<!-- product tab nav -->
					<ul class="tab-nav">

						<li class="active"><a data-toggle="tab" href="#tab3">Reviews ( @Model.product.Reviews.Count )</a></li>
						<li ><a data-toggle="tab" href="#tab1">Description</a></li>

					</ul>
					<!-- /product tab nav -->
					<!-- product tab content -->
					<div class="tab-content">
						<!-- tab1  -->
						<div id="tab1" class="tab-pane fade in active">
							<div class="row">
								<div class="col-md-12">
									<p>
										@Model.product.Description
									</p>
								</div>
							</div>
						</div>
						<!-- /tab1  -->
 
						<!-- tab3  -->
						<div id="tab3" class="tab-pane fade in active">
							<div class="row">
								<!-- Rating -->
								<div class="col-md-3">
									<div id="rating">
										<div class="rating-avg">
											<span>@avgRating</span>
											<div class="rating-stars">
												@for (int i = 0; i < fullStars; i++)
												{ <!-- نجمة كاملة -->
													<i class="fa fa-star"></i>
												} 
												@if (halfStar)
												{ <!-- نص نجمة -->
													<i class="fa fa-star-half-o"></i>
												} 
												@for (int i = 0; i < emptyStars; i++)
												{ <!-- نجمة فاضية -->
													<i class="fa fa-star-o"></i> 
												}
											</div>
										</div>
										<ul class="rating">
											<li>
												<div class="rating-stars">
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
												</div>
												<div class="rating-progress">
													<div style="width: 100%;"></div>
												</div>
												<span class="sum">5</span>
											</li>
											<li>
												<div class="rating-stars">
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star-o"></i>
												</div>
												<div class="rating-progress">
													<div style="width: 80%;"></div>
												</div>
												<span class="sum">4</span>
											</li>
											<li>
												<div class="rating-stars">
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star-o"></i>
													<i class="fa fa-star-o"></i>
												</div>
												<div class="rating-progress">
													<div style="width: 60%;"></div>
												</div>
												<span class="sum">3</span>
											</li>
											<li>
												<div class="rating-stars">
													<i class="fa fa-star"></i>
													<i class="fa fa-star"></i>
													<i class="fa fa-star-o"></i>
													<i class="fa fa-star-o"></i>
													<i class="fa fa-star-o"></i>
												</div>
												<div class="rating-progress">
													<div style="width: 40%;"></div>
												</div>
												<span class="sum">2</span>
											</li>
											<li>
												<div class="rating-stars">
													<i class="fa fa-star"></i>
													<i class="fa fa-star-o"></i>
													<i class="fa fa-star-o"></i>
													<i class="fa fa-star-o"></i>
													<i class="fa fa-star-o"></i>
												</div>
												<div class="rating-progress">
													<div style="width: 20%;"></div>
												</div>
												<span class="sum">1</span>
											</li>
										</ul>
									</div>
								</div>
								<!-- /Rating -->
								<!-- Reviews -->
								<div class="col-md-6">
									<div id="reviews">
 											@if (Model.product.Reviews.Count==0)
											{
  														<h3>
															No Review And comment											
														</h3>
												
 											}
											else 
											{ 	
												<ul class="reviews">

													@foreach (var review in Model.TopReviews)
													{
														<li>
															<div class="review-heading">
																<h5 class="name">@review.Customer.FullName</h5>
																<p class="date">@review.CreatedAt</p>
																<div class="review-rating">
																	@for (int i = 0; i < fullStars; i++)
																	{
																		<!-- نجمة كاملة -->
																		<i class="fa fa-star"></i>
																	}
																	@if (halfStar)
																	{
																		<!-- نص نجمة -->
																		<i class="fa fa-star-half-o"></i>
																	}
																	@for (int i = 0; i < emptyStars; i++)
																	{
																		<!-- نجمة فاضية -->
																		<i class="fa fa-star-o"></i>
																	}
																</div>
															</div>
															<div class="review-body">
																<p>
 																	@review.Comment
																</p>
															</div>
														</li>
											
													}

												</ul>
												@if (User.IsInRole("Admin"))
												{
													<div class=" mt-3 primary-btn text-center">
														<a  asp-controller="Seller" asp-action="ViewReviewAndComment" asp-route-id="@Model.ProductId"  class="text-white">
															Show All Reviews
														</a>
													</div>
												}
											

											}  
									</div>
								</div>
								<!-- /Reviews -->
								<!-- Review Form -->
								<div class="col-md-3">
									<div id="review-form">
										<form class="review-form" asp-controller="Product" asp-action="AddReview">
 											<textarea class="input" asp-for="Comment" placeholder="Your Review"></textarea>
											<div class="input-rating">
												<span>Your Rating: </span>
												<div class="stars">
													<input id="star5" asp-for="Rating" value="5" type="radio"><label for="star5"></label>
													<input id="star4" asp-for="Rating" value="4" type="radio"><label for="star4"></label>
													<input id="star3" asp-for="Rating" value="3" type="radio"><label for="star3"></label>
													<input id="star2" asp-for="Rating" value="2" type="radio"><label for="star2"></label>
													<input id="star1" asp-for="Rating" value="1" type="radio"><label for="star1"></label>
												</div>
											</div>
											<input type="hidden" asp-for="ProductId" />

											<button class="primary-btn">Submit</button>
										</form>
									</div>
								</div>
								<!-- /Review Form -->
							</div>
						</div>
						<!-- /tab3  -->
					</div>
					<!-- /product tab content  -->
				</div>
			</div>
			<!-- /product tab -->
		</div>
		<!-- /row -->
	</div>
	<!-- /container -->
</div>
<!-- /SECTION -->
 				 
<!-- Section -->
<div class="section">
	<!-- container -->
	<div class="container">
		<!-- row -->
		<div class="row">

			<div class="col-md-12">
				<div class="section-title text-center">
					<h3 class="title">Related Products</h3>
				</div>
			</div>

			<!-- /section title -->
			<!-- Products tab & slick -->
			<div class="col-md-12">
				<div class="row">
					<div class="products-tabs">
						<!-- tab -->
						<div id="tab1" class="tab-pane active">
							<div class="products-slick" data-nav="#slick-nav-1">
								@foreach (var item in Model.listProduct)
								{

									<!-- product -->
									<div class="product">
										<div class="product-img " style=" max-height: 230px;min-height: 230px; height: auto;">
											<img src="~/img/@item.ImageUrl"
												 style="width: 100%; height: 230px; object-fit: contain;"
												 alt="">

											<div class="product-label">
												<span class="sale">-30%</span>
												<span class="new">NEW</span>
											</div>
										</div>
										<div class="product-body">
											<p class="product-category">@item.Category.Name</p>
											<h3 class="product-name"><a href="#">@item.Name</a></h3>
											<h4 class="product-price">$@item.Price <del class="product-old-price">$990.00</del></h4>
											<div class="product-rating">
												@{
													double AvgRating = item.AverageRating;
													int FullStars = (int)AvgRating;
													bool HalfStar = AvgRating - FullStars >= 0.5;
													int EmptyStars = 5 - FullStars - (HalfStar ? 1 : 0);
												}
												@for (int i = 0; i < FullStars; i++)
												{
													<!-- نجمة كاملة -->
													<i class="fa fa-star"></i>
												}
												@if (HalfStar)
												{
													<!-- نص نجمة -->
													<i class="fa fa-star-half-o"></i>
												}
												@for (int i = 0; i < EmptyStars; i++)
												{
													<!-- نجمة فاضية -->
													<i class="fa fa-star-o"></i>
												}
											</div>
											<div class="product-btns">

												<form asp-controller="Wishlists" asp-action="AddWishList" method="post" style="display:inline;">
													@Html.AntiForgeryToken()
													<input type="hidden" name="id" value="@item.Id" />
													<button class="add-to-wishlist" type="submit" style="all: unset; cursor: pointer;">
														<i class="fa fa-heart-o"></i><span class="tooltipp"> </span>
													</button>
												</form>

												<button class="add-to-compare"><i class="fa fa-exchange"></i><span class="tooltipp">add to compare</span></button>

												<button class="quick-view">
													<a asp-controller="Product" asp-action="Details" asp-route-id="@item.Id">
														<i class="fa fa-eye"></i>
													</a>
													<span class="tooltipp">quick view</span>
												</button>

											</div>
										</div>

										<div class="add-to-cart">
											<form asp-action="AddToCart" asp-controller="CartItem" method="post">

												<input type="hidden" name="id" value="@item.Id" />

												<button type="submit" class="add-to-cart-btn"> <i class="fa fa-shopping-cart"></i> add to cart</button>


											</form>
										</div>


									</div>
									<!-- /product -->
								}

							</div>
							<div id="slick-nav-1" class="products-slick-nav"></div>
						</div>
						<!-- /tab -->
					</div>
				</div>
			</div>
			<!-- Products tab & slick -->
		</div>
		<!-- /row -->
		</div>
		<!-- /row -->
	</div>
	<!-- /container -->
</div>
<!-- /Section -->
<!-- NEWSLETTER -->
<div id="newsletter" class="section">
	<!-- container -->
	<div class="container">
		<!-- row -->
		<div class="row">
			<div class="col-md-12">
				<div class="newsletter">
					<p>Sign Up for the <strong>NEWSLETTER</strong></p>
					<form>
						<input class="input" type="email" placeholder="Enter Your Email">
						<button class="newsletter-btn"><i class="fa fa-envelope"></i> Subscribe</button>
					</form>
					<ul class="newsletter-follow">
						<li>
							<a href="#"><i class="fa fa-facebook"></i></a>
						</li>
						<li>
							<a href="#"><i class="fa fa-twitter"></i></a>
						</li>
						<li>
							<a href="#"><i class="fa fa-instagram"></i></a>
						</li>
						<li>
							<a href="#"><i class="fa fa-pinterest"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<!-- /row -->
	</div>
	<!-- /container -->
</div>
<!-- /NEWSLETTER -->